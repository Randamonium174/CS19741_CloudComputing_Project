<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Ziyara Staff Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

  <style>
    :root {
      --deep1: #2e1a47;
      --deep2: #0b0f1a;
      --gold: #d4af37;
      --muted: rgba(255,255,255,0.9);
      --muted-light: rgba(255,255,255,0.7);
    }
    body {
      background: linear-gradient(135deg, var(--deep1) 0%, #1a1530 40%, var(--deep2) 100%);
      color: var(--muted);
      font-family: "Poppins", sans-serif;
      min-height: 100vh;
      padding: 30px 20px;
    }
    h1 {
      color: var(--gold);
      font-weight: 700;
      margin-bottom: 30px;
      /* Removed glow */
      /* text-shadow: 0 0 8px var(--gold); */
    }
    #search-input {
      max-width: 450px;
      margin-bottom: 20px;
      background: var(--deep2);
      border: 1px solid var(--gold);
      color: var(--muted);
      font-weight: 600;
    }
    #search-input::placeholder {
      color: var(--muted-light);
      font-style: italic;
    }
    #search-input:focus {
      background: var(--deep1);
      border-color: #ffdd66;
      color: #fff;
      /* Removed glow */
      /* box-shadow: 0 0 8px #ffdd66; */
    }

    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0 10px;
      font-size: 1rem;
      /* Removed shadow */
      /* box-shadow: 0 8px 30px rgba(0,0,0,0.5); */
      background: var(--deep2);
      border-radius: 14px;
      overflow: hidden;
    }
    thead tr {
      background: var(--deep1);
      color: var(--gold);
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.04em;
      /* Removed inset shadow */
      /* box-shadow: inset 0 -3px 8px rgba(212,175,55,0.4); */
    }
    thead th {
      padding: 14px 18px;
      border-bottom: 2px solid var(--gold);
    }
    tbody tr {
      background: #1a1530;
      color: var(--muted);
      transition: background 0.3s ease;
    }
    tbody tr:hover {
      background: var(--deep1);
      color: #fff;
      cursor: pointer;
    }
    tbody td {
      padding: 12px 18px;
      vertical-align: middle;
    }
    tbody td:first-child {
      font-weight: 600;
      color: var(--gold);
    }

    .status-badge {
      font-weight: 600;
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 0.85rem;
      display: inline-block;
      min-width: 95px;
      text-align: center;
      user-select: none;
      transition: background-color 0.3s ease;
      /* Removed glow */
      /* box-shadow: 0 0 6px ... */
    }
    .status-in {
      background-color: #28a745;
      color: #fff;
    }
    .status-out {
      background-color: #dc3545;
      color: #fff;
    }
    .status-pending {
      background-color: #ffc107;
      color: #222;
    }

    .btn-checkin, .btn-checkout {
      font-weight: 600;
      border: none;
      padding: 7px 14px;
      border-radius: 10px;
      /* Removed shadows */
      /* box-shadow: 0 3px 12px rgba(0,0,0,0.3); */
      transition: transform 0.15s ease;
      cursor: pointer;
      user-select: none;
    }
    .btn-checkin {
      background: linear-gradient(90deg, #5bd65b, #28a745);
      color: white;
    }
    .btn-checkin:hover {
      background: linear-gradient(90deg, #45c145, #1f7f2f);
      transform: scale(1.05);
    }
    .btn-checkout {
      background: linear-gradient(90deg, #e85757, #dc3545);
      color: white;
    }
    .btn-checkout:hover {
      background: linear-gradient(90deg, #c04343, #a32e2e);
      transform: scale(1.05);
    }

    #export-btn {
      margin-top: 20px;
      background: var(--gold);
      border: none;
      color: #111;
      font-weight: 700;
      padding: 12px 30px;
      border-radius: 14px;
      /* Removed box shadow */
      /* box-shadow: 0 5px 20px rgba(212,175,55,0.6); */
      transition: box-shadow 0.3s ease;
    }
    #export-btn:hover {
      /* Removed glow */
      /* box-shadow: 0 8px 30px rgba(255, 223, 102, 0.8); */
      color: #000;
    }
  </style>
</head>
<body>

  <h1><i class="fa fa-tachometer-alt"></i> Ziyara Staff Dashboard</h1>

  <input type="text" id="search-input" class="form-control" placeholder="Search visitors by name or purpose...">

  <table aria-label="Visitor list table" role="grid" cellspacing="0" cellpadding="0">
    <thead>
      <tr>
        <th scope="col">Visitor Name</th>
        <th scope="col">Purpose</th>
        <th scope="col">Valid Until</th>
        <th scope="col">Status</th>
        <th scope="col">Check-in Time</th>
        <th scope="col">Actions</th>
      </tr>
    </thead>
    <tbody id="visitor-table-body">
      <!-- dynamic rows -->
    </tbody>
  </table>

  <button id="export-btn" title="Export visitor list as CSV"><i class="fa fa-file-export"></i> Export CSV</button>

  <!-- Font Awesome JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/js/all.min.js"></script>

  <script>
    let visitors = [
      {
        id: "ZYA-abc123",
        name: "John Doe",
        purpose: "Interview",
        validUntil: "Aug 11, 2025, 3:00 PM",
        status: "pending",
        checkInTime: null
      },
      {
        id: "ZYA-def456",
        name: "Jane Smith",
        purpose: "DEPT_EVENT",
        validUntil: "Aug 11, 2025, 5:00 PM",
        status: "in",
        checkInTime: "2025-08-11T14:15:00"
      },
      {
        id: "ZYA-ghi789",
        name: "Michael Johnson",
        purpose: "Presentation",
        validUntil: "Aug 11, 2025, 6:00 PM",
        status: "out",
        checkInTime: "2025-08-11T10:45:00"
      }
    ];

    const visitorTableBody = document.getElementById('visitor-table-body');
    const searchInput = document.getElementById('search-input');
    const exportBtn = document.getElementById('export-btn');

    function renderTable() {
      const filter = searchInput.value.toLowerCase();
      visitorTableBody.innerHTML = '';

      const filteredVisitors = visitors.filter(v =>
        v.name.toLowerCase().includes(filter) ||
        v.purpose.toLowerCase().includes(filter)
      );

      if (filteredVisitors.length === 0) {
        visitorTableBody.innerHTML = `<tr><td colspan="6" class="text-center text-muted" style="color: var(--muted-light);">No visitors found</td></tr>`;
        return;
      }

      filteredVisitors.forEach(v => {
        const tr = document.createElement('tr');

        // Name
        const tdName = document.createElement('td');
        tdName.textContent = v.name;
        tr.appendChild(tdName);

        // Purpose
        const tdPurpose = document.createElement('td');
        tdPurpose.textContent = v.purpose;
        tr.appendChild(tdPurpose);

        // Valid Until
        const tdValid = document.createElement('td');
        tdValid.textContent = v.validUntil;
        tr.appendChild(tdValid);

        // Status with badge
        const tdStatus = document.createElement('td');
        const spanStatus = document.createElement('span');
        spanStatus.classList.add('status-badge');
        if (v.status === 'in') {
          spanStatus.classList.add('status-in');
          spanStatus.textContent = 'Checked In';
        } else if (v.status === 'out') {
          spanStatus.classList.add('status-out');
          spanStatus.textContent = 'Checked Out';
        } else {
          spanStatus.classList.add('status-pending');
          spanStatus.textContent = 'Pending';
        }
        tdStatus.appendChild(spanStatus);
        tr.appendChild(tdStatus);

        // Check-in Time
        const tdCheckin = document.createElement('td');
        tdCheckin.textContent = v.checkInTime ? new Date(v.checkInTime).toLocaleString() : '-';
        tr.appendChild(tdCheckin);

        // Actions
        const tdActions = document.createElement('td');
        if (v.status === 'pending') {
          const btnCheckin = document.createElement('button');
          btnCheckin.className = 'btn-checkin';
          btnCheckin.textContent = 'Check In';
          btnCheckin.onclick = () => handleCheckin(v.id);
          tdActions.appendChild(btnCheckin);
        } else if (v.status === 'in') {
          const btnCheckout = document.createElement('button');
          btnCheckout.className = 'btn-checkout';
          btnCheckout.textContent = 'Check Out';
          btnCheckout.onclick = () => handleCheckout(v.id);
          tdActions.appendChild(btnCheckout);
        } else {
          tdActions.textContent = '-';
        }
        tr.appendChild(tdActions);

        visitorTableBody.appendChild(tr);
      });
    }

    function handleCheckin(id) {
      const visitor = visitors.find(v => v.id === id);
      if (!visitor) return;
      visitor.status = 'in';
      visitor.checkInTime = new Date().toISOString();
      renderTable();
    }

    function handleCheckout(id) {
      const visitor = visitors.find(v => v.id === id);
      if (!visitor) return;
      visitor.status = 'out';
      renderTable();
    }

    function exportCSV() {
      const header = ['ID', 'Name', 'Purpose', 'Valid Until', 'Status', 'Check-in Time'];
      const rows = visitors.map(v => [
        v.id,
        v.name,
        v.purpose,
        v.validUntil,
        v.status,
        v.checkInTime ? new Date(v.checkInTime).toLocaleString() : ''
      ]);
      let csvContent = "data:text/csv;charset=utf-8," 
        + header.join(",") + "\n"
        + rows.map(e => e.map(a => `"${a}"`).join(",")).join("\n");

      const encodedUri = encodeURI(csvContent);
      const a = document.createElement('a');
      a.setAttribute('href', encodedUri);
      a.setAttribute('download', `ziyara_visitors_${new Date().toISOString().slice(0,10)}.csv`);
      document.body.appendChild(a);
      a.click();
      a.remove();
    }

    searchInput.addEventListener('input', renderTable);
    exportBtn.addEventListener('click', exportCSV);

    renderTable();

    // Optional: Simulate live updates (remove or adjust as needed)
    setInterval(() => {
      if (Math.random() < 0.3) {
        visitors.push({
          id: 'ZYA-' + Math.random().toString(36).slice(2, 8).toUpperCase(),
          name: 'Visitor ' + Math.floor(Math.random()*1000),
          purpose: ['DEPT_EVENT','Interview','Presentation','Maintenance'][Math.floor(Math.random()*4)],
          validUntil: 'Aug 11, 2025, 7:00 PM',
          status: 'pending',
          checkInTime: null
        });
        renderTable();
      }
    }, 30000);
  </script>
</body>
</html>
